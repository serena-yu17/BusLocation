function escapeHtml(n){return String(n).replace(/[&<>"'`=\/]/g,function(n){return entityMap[n]})}function initMap(){map=new google.maps.Map(document.getElementById("map"),{zoom:13});navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(n){initialLocation=new google.maps.LatLng(n.coords.latitude,n.coords.longitude);map.setCenter(initialLocation)})}const entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var map;$(window).on("load",function(){function h(){e();t=setInterval(function(){if(document.getElementById("map").classList.contains("hidden")){t&&clearInterval(t);return}e()},15e3);u&&clearTimeout(u);u=setTimeout(function(){t&&clearInterval(t)},6e5)}function c(){var i=document.getElementById("route"),t=i.value.trim();t!=""&&(document.getElementById("searchRoute").disabled=!0,document.getElementById("map").classList.add("hidden"),$.ajax({type:"GET",url:tripUrl,data:{route:t},success:function(t){if(t){let r=!0;for(let n in t)if(t.hasOwnProperty(n)){r=!1;break}if(r){document.getElementById("directionForm").classList.add("hidden");return}document.getElementById("directionForm").classList.remove("hidden");let i=0;for(let r in t)if(t.hasOwnProperty(r)){let u=document.createElement("label");u.classList.add("form-control");let f="directionRadio"+i.toString(),e='<input type="radio" name="direction" id="'+f+'"/> '+escapeHtml(r);i===0&&(e='<input type="radio" name="direction" id="'+f+'" checked/> '+escapeHtml(r));u.innerHTML=e;let o="directionOption"+i.toString();u.id=o;document.getElementById("directionOptions").appendChild(u);n[o]={radID:f,trips:t[r]};i++}}},error:function(n){console.log(n)},complete:function(){document.getElementById("searchRoute").disabled=!1;waitingUpd=!1}}))}function e(){let t=null;for(let i in n)if(n.hasOwnProperty(i)){var r=n[i].radID;let u=document.getElementById(r);if(u&&u.checked){t=n[i].trips;break}}if(t!==null&&t.length!==0){let n=[];for(let i=0;i<t.length;i++)n.push(t[i].toString());let r={tripIDs:n.join(",")};document.getElementById("submit").disabled=!0;$.ajax({type:"GET",url:locUrl,data:r,success:function(n){if(n){let t=!0;for(let i in n)if(n.hasOwnProperty(i)){t=!1;break}if(t){document.getElementById("map").classList.add("hidden");return}document.getElementById("map").classList.remove("hidden");for(let n=0;n<i.length;n++)i[n].setMap(null);i.length=0;for(let t in n)if(n.hasOwnProperty(t)){let r=n[t].coordinate.latitude,u=n[t].coordinate.longitude,f=n[t].occupancy,e=new google.maps.Marker({position:new google.maps.LatLng(r,u),icon:o,label:{text:f,color:"#BE1616",fontSize:"16px",fontWeight:"bold"},map:map});i.push(e)}navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(n){userLoc=new google.maps.LatLng(n.coords.latitude,n.coords.longitude);let t=new google.maps.Marker({position:userLoc,icon:s,label:{text:"I am here",color:"#2916BE",fontSize:"16px",fontWeight:"bold"},map:map})})}},error:function(n){console.log(n)},complete:function(){document.getElementById("submit").disabled=!1}})}}const o={url:"/images/Bus.svg",scaledSize:new google.maps.Size(30,30),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(10,10),labelOrigin:new google.maps.Point(0,-5)},s={url:"/images/crosshair.svg",scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(5,5),labelOrigin:new google.maps.Point(10,-5)};var n={},i=[],t=null,u=null,r={},f=new Set;setInterval(function(){r={};f.clear()},864e5);document.getElementById("searchRoute").onclick=function(){event.preventDefault();for(let t in n)if(n.hasOwnProperty(t)){let n=document.getElementById(t);n&&n.parentElement.removeChild(n)}n={};c()};document.getElementById("submit").onclick=function(){event.preventDefault();h()}});